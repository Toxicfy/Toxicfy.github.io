<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://toxicfy.github.io/</id>
    <title>Fyçš„ä¸ªäººå°ç«™</title>
    <updated>2020-02-02T06:00:58.390Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://toxicfy.github.io/"/>
    <link rel="self" href="https://toxicfy.github.io/atom.xml"/>
    <logo>https://toxicfy.github.io/images/avatar.png</logo>
    <icon>https://toxicfy.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Fyçš„ä¸ªäººå°ç«™</rights>
    <entry>
        <title type="html"><![CDATA[æ•°æ®äº¤äº’ -- Axios çš„å°è£…åŠ API æ¥å£ç®¡ç†]]></title>
        <id>https://toxicfy.github.io/post/xiang-mu-axios-de-feng-zhuang-ji-api-jie-kou-guan-li</id>
        <link href="https://toxicfy.github.io/post/xiang-mu-axios-de-feng-zhuang-ji-api-jie-kou-guan-li">
        </link>
        <updated>2020-01-13T07:33:49.000Z</updated>
        <summary type="html"><![CDATA[<p>ä¸ºäº†ç®€åŒ–æ•°æ®äº¤äº’çš„ä»£ç ä»¥åŠåç»­ä»£ç çš„ä¿®æ”¹æ›´æ–°ç»´æŠ¤ï¼Œåœ¨ <code>Vue</code> é¡¹ç›®ä¸­æˆ‘ä»¬ä¼šéœ€è¦å¯¹ axios åº“è¿›è¡Œè¿›ä¸€æ­¥çš„å°è£…å¹¶é›†ä¸­ç®¡ç† api æ•°æ®è¯·æ±‚ï¼›</p>
]]></summary>
        <content type="html"><![CDATA[<p>ä¸ºäº†ç®€åŒ–æ•°æ®äº¤äº’çš„ä»£ç ä»¥åŠåç»­ä»£ç çš„ä¿®æ”¹æ›´æ–°ç»´æŠ¤ï¼Œåœ¨ <code>Vue</code> é¡¹ç›®ä¸­æˆ‘ä»¬ä¼šéœ€è¦å¯¹ axios åº“è¿›è¡Œè¿›ä¸€æ­¥çš„å°è£…å¹¶é›†ä¸­ç®¡ç† api æ•°æ®è¯·æ±‚ï¼›</p>
<!-- more -->
<blockquote>
<p><code>axios</code> æœ¬è´¨è¿˜æ˜¯ ajaxï¼Œä¸è¿‡æ˜¯ä¸ºäº†è§£å†³ ajax ç¹ççš„è¯·æ±‚æ–¹å¼ä»¥åŠæ›´å¥½çš„å¤„ç†å›è°ƒï¼› <code>axios</code> æ˜¯ç”± ajax å’Œ promise å°è£…çš„ HTTP åº“; ä¸»è¦è¿™å‡ ä¸ªéƒ¨åˆ†è¯´æ˜é¡¹ç›®ä¸­å‰åç«¯æ•°æ®äº¤äº’çš„è¯·æ±‚ç®¡ç†</p>
</blockquote>
<ul>
<li>é…ç½®å’Œåˆ›å»º <code>axios</code> å®ä¾‹</li>
<li>è¯·æ±‚åŠå“åº”çš„å¤„ç† (transformRequest å¯ä»¥ä¿®æ”¹ä¼ è¾“çš„æ•°æ®ï¼ŒvalidateStatus ç”¨äºå†³å®šé‚£äº›çŠ¶æ€ä¼šè¢« catch æ•è·ä»¥ä¾¿äºå¤„ç†)</li>
<li>api æ¥å£çš„ç®¡ç†</li>
</ul>
<p>é¦–å…ˆè€ƒè™‘åœ¨ <code>src</code> æ–‡ä»¶ç›®å½•ä¸‹å»ºç«‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å¤¹ <code>api/http.js</code></p>
<p>æˆ‘ä»¬ä»£ç çš„å°è£…å°±åœ¨ http.js å†…å®Œæˆï¼Œä¸ºäº†é˜²æ­¢ axios è¢«å…¨å±€'æ±¡æŸ“'ï¼Œæˆ‘ä»¬é€šè¿‡åˆ›å»º axios å®ä¾‹å’Œé…ç½®é¡¹å¼€å§‹ï¼›</p>
<h3 id="axios-å°è£…">Axios å°è£…</h3>
<h4 id="åŒºåˆ†ç¯å¢ƒ-baseurlè¶…æ—¶è¯·æ±‚å¤´æ ¼å¼ä¿®æ”¹">åŒºåˆ†ç¯å¢ƒ baseURL/è¶…æ—¶/è¯·æ±‚å¤´æ ¼å¼ä¿®æ”¹</h4>
<pre><code class="language-javascript">import axios from 'axios'
import qs from 'qs'

const service = axios.create{
    // åŒºåˆ†çŠ¶æ€ï¼Œæ›´æ¢ä¸åŒçš„URL
    baseURL: process.env.NODE_ENV === 'production' ? 'productionUrl' : 'devUrl',
    // è®¾ç½®è¶…æ—¶æ—¶é—´
    timeOut: 10000,
}
// è®¾ç½®postçš„è¯·æ±‚å¤´æ ¼å¼
service.defaults.headers.post['Content-Type'] =
  'application/x-www-form-urlencoded;charset=UTF-8';
</code></pre>
<h3 id="è¯·æ±‚-å“åº”å¤„ç†-æ‹¦æˆªå™¨">è¯·æ±‚ã€å“åº”å¤„ç† (æ‹¦æˆªå™¨)</h3>
<ul>
<li><code>transformRequest</code> å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®ï¼›<code>transformResponse</code> åœ¨ä¼ é€’ç»™ then/catch å‰ï¼Œå…è®¸ä¿®æ”¹å“åº”æ•°æ®</li>
<li>axios æä¾›äº† <code>validateStatus</code> å±æ€§ï¼Œç”¨äºå®šä¹‰å¯¹äºç»™å®šçš„<code>HTTP</code> å“åº”çŠ¶æ€ç æ˜¯ <code>resolve</code> æˆ– <code>reject</code> promiseã€‚ è¿™é‡ŒæåŠä½†æ˜¯å¯ä»¥ä¸ä½œä¿®æ”¹ï¼Œé»˜è®¤ <code>status &gt;= 200 &amp;&amp; status &lt; 300</code> , å…¶ä»–çŠ¶æ€å‡åœ¨ <code>onReject</code> ä¸­è¿›è¡Œå¤„ç†ï¼›</li>
</ul>
<pre><code class="language-javascript">import router from '../router'

// åºåˆ—åŒ–æ•°æ®è¯·æ±‚
service.defaults.transformRequest = data =&gt; qs.stringify(data)

const backToLogin = () =&gt; {
  router.replace({ path: '/login' })
}

// æ ¹æ® status ç”Ÿæˆ msg åŠæ“ä½œ
const handleErrStatus = status =&gt; {
  switch (status) {
    case 401:
      backToLogin()
      return 'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'
    case 403:
      localStorage.removeItem('token')
      store.commit('clearToken')
      backToLogin()
      return 'ç™»å½•è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•'
    case 404:
      return 'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'ï¼Œ
  }
  String(status).match(/^(5)/) &amp;&amp; return 'æœåŠ¡ç«¯å‡ºé”™ï¼Œè¯·è”ç³»ç®¡ç†å‘˜'
}
</code></pre>
<pre><code class="language-javascript">// æç¤º
import { Toast } from 'vant'
const showMsg = msg =&gt;
  Toast({ message: msg, duration: 1000, forbidClick: true })

// å¤„ç†è¯·æ±‚éƒ¨åˆ†çš„æ‹¦æˆª
service.interceptor.request.use(
  config =&gt; {
    // è·å–å¹¶è®¾ç½® token
    const token = store.state.token || localStorage.getItem('token')
    token &amp;&amp; (config.header.Authorization = token)
    return config
  },
  err =&gt; {
    Promise.error(err)
  }
)
// å¤„ç†æ•°æ®çš„å“åº”
service.interceptor.response.use(
  res =&gt; res,
  error =&gt; {
    const { response } = error
    // å¦‚æœæœ‰responseï¼Œåˆ™è¯´æ˜è¯¥è¯·æ±‚å·²å‘èµ·ï¼Œä½†æ˜¯é”™è¯¯
    if (response) {
      // å…¨å±€æç¤º
      showMsg(handleErrStatus(response.status))
      return Promise.resolve(response)
    }
    return Promise.reject(error)
  }
)
</code></pre>
<h3 id="api-çš„ç®¡ç†">Api çš„ç®¡ç†</h3>
<p>ä¸ºäº†é¿å…é‡å¤çš„ç¼–å†™è¯·æ±‚ä½“ä»¥åŠé›†ä¸­ç®¡ç†ï¼Œæˆ‘ä»¬ä¼šå¯¹ <code>get</code> åŠ <code>post</code> è¯·æ±‚åšä¸€æ¬¡å°è£…ï¼› æˆ‘ä»¬åœ¨ <code>http.js</code> çš„åŒçº§ä¸‹å»ºç«‹ <code>api.js</code> ;</p>
<p>å…ˆåè¿‡æ¥ï¼Œå…ˆç¡®å®šæˆ‘ä»¬æƒ³è¦æ€æ ·çš„è°ƒç”¨å½¢å¼ï¼Œä¹‹åç¡®å®šå°è£…æ–¹å¼</p>
<pre><code class="language-javascript">//api
export const getDeviceList = data =&gt; get('api/Device/getDeviceList', data)
export const updateDevice = data =&gt; post('api/Device/updateDevice', data)
</code></pre>
<p>æ³¨ï¼š å½“æ•°æ®æ¥å£å¤šçš„æ—¶å€™ï¼Œä½¿ç”¨æ¨¡å—åŒ–ç®¡ç†æ¥å£ï¼Œapi.js ä¸º api é›†åˆçš„å¯¼å‡ºå£, è€Œå¯¹åº”çš„æ¨¡å—å†…å®¹å‚ç…§å¦‚ä¸Šæ‰€è¿°çš„ç¼–å†™</p>
<pre><code class="language-javascript">// api.js
import funcModule1 from './funcModule1'
import funcModule2 from './funcModule2'

export default {
  funcModule1,
  funcModule2
}
</code></pre>
<p>å¦‚æ­¤ï¼Œæˆ‘ä»¬æ„å»ºå‡ºè¿”å›å€¼ Promise å¯¹è±¡çš„å‡½æ•°ä½œä¸ºå…¬ç”¨çš„å‡½æ•°</p>
<pre><code class="language-javascript">// http.js
export const get = (url, params, config = {}) =&gt; {
  return new Promise((resolve, reject) =&gt; {
      service({
        methods: 'get',
        url,
        params
      })
        .then(res =&gt; resolve(res))
        .catch(err =&gt; reject(err))
  })
}
export const post = (url, data, config = {}) =&gt; {
  return new Promise((resolve, reject) =&gt; {
      service({
        methods: 'post',
        url,
        data
        ...config
      })
        .then(res =&gt; resolve(res))
        .catch(err =&gt; reject(err))
  })
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä¹¦ç±ç¬”å½•  --ã€Šå›¾è§£HTTPã€‹]]></title>
        <id>https://toxicfy.github.io/post/shu-ji-zong-jie-tu-jie-http</id>
        <link href="https://toxicfy.github.io/post/shu-ji-zong-jie-tu-jie-http">
        </link>
        <updated>2019-10-09T02:42:04.000Z</updated>
        <summary type="html"><![CDATA[<p>å·¥ä½œæ‰“äº¤é“æœ€å¤šçš„è¿˜æ˜¯æµè§ˆå™¨ï¼Œå¯¹äºè¾“å…¥<code>URL</code>åˆ°é¡µé¢å‘ˆç°çš„æ­¥éª¤ç±»ä¼¼çš„æ–‡ç« å…¶å®ä¹Ÿæ˜¯çœ‹äº†ä¸å°‘ï¼Œä½†æ˜¯è¿˜æ˜¯è§‰å¾—å·®ç‚¹ä»€ä¹ˆï¼›æœ€åé€‰äº†ã€Šå›¾è§£HTTPã€‹è¿™æœ¬ä¹¦ï¼ŒåŸºæœ¬ä¹Ÿè¦†ç›–äº†<code>HTTP</code>åè®®ä¸­çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œè‡ªå·±ä¹Ÿè¿›è¡Œäº†çŸ¥è¯†ç‚¹æç‚¼å’Œæ€»ç»“ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ï¼›</p>
]]></summary>
        <content type="html"><![CDATA[<p>å·¥ä½œæ‰“äº¤é“æœ€å¤šçš„è¿˜æ˜¯æµè§ˆå™¨ï¼Œå¯¹äºè¾“å…¥<code>URL</code>åˆ°é¡µé¢å‘ˆç°çš„æ­¥éª¤ç±»ä¼¼çš„æ–‡ç« å…¶å®ä¹Ÿæ˜¯çœ‹äº†ä¸å°‘ï¼Œä½†æ˜¯è¿˜æ˜¯è§‰å¾—å·®ç‚¹ä»€ä¹ˆï¼›æœ€åé€‰äº†ã€Šå›¾è§£HTTPã€‹è¿™æœ¬ä¹¦ï¼ŒåŸºæœ¬ä¹Ÿè¦†ç›–äº†<code>HTTP</code>åè®®ä¸­çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œè‡ªå·±ä¹Ÿè¿›è¡Œäº†çŸ¥è¯†ç‚¹æç‚¼å’Œæ€»ç»“ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ï¼›</p>
<!-- more -->
<h2 id="uwebåŠç½‘ç»œåŸºç¡€u"><u>WebåŠç½‘ç»œåŸºç¡€</u></h2>
<p>Web æ˜¯å»ºç«‹åœ¨ <code>HTTP</code> åè®®ä¸Šé€šä¿¡çš„ï¼Œè€Œ <code>HTTP</code> æ˜¯ <code>TCP/IP</code> åè®®æ—å†…éƒ¨çš„ä¸€ä¸ªå­é›†ã€‚</p>
<h3 id="tcpip-åè®®æ—">ğŸ“Œ<code>TCP/IP</code> åè®®æ—</h3>
<p>ä¸ºäº†æ»¡è¶³ä¸åŒçš„ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œéœ€è¦åˆ¶å®šçº¦æŸçš„è§„åˆ™ï¼Œè€Œè¿™äº›è§„åˆ™ä¹Ÿå°±ç§°ä¸º<strong>åè®®</strong>ï¼›è€Œ <code>TCP/IP</code> æŒ‡çš„æ˜¯ <code>TCP</code> å’Œ <code>IP</code> ä¸¤ç§åè®®ï¼Œä¹Ÿæœ‰è¯´æ³•æ˜¯ <code>IP</code> åè®®é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨åˆ°çš„åè®®æ—çš„ç»Ÿç§°ã€‚</p>
<p><code>TCP/IP</code> åè®®æ—æ˜¯<strong>åŸºäºåˆ†å±‚è¿›è¡Œç®¡ç†</strong>çš„ï¼Œåˆ†å±‚åŒ–çš„è®¾è®¡ä½¿å¾—æ”¹åŠ¨ä»¥åŠä»»åŠ¡åˆ’åˆ†æ›´åŠ æ¸…æ™°ï¼›</p>
<figure data-type="image" tabindex="1"><img src="https://pic.superbed.cn/item/5d9da3b2451253d178933125.png" alt="TCP/IPåˆ†å±‚" loading="lazy"></figure>
<p>åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯åœ¨<strong>åº”ç”¨å±‚</strong>ï¼ˆ<code>HTTP</code>åè®®ï¼‰å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œç”Ÿæˆè¯·æ±‚çš„<code>HTTP</code>æŠ¥æ–‡ï¼Œä¸ºäº†ä¼ è¾“æ–¹ä¾¿ï¼Œåœ¨<strong>ä¼ è¾“å±‚</strong>ï¼ˆ<code>TCP</code>åè®®ï¼‰å°†è·å–åˆ°çš„æŠ¥æ–‡åˆ‡å‰²æˆæŠ¥æ–‡æ®µè½¬å‘ç»™<strong>ç½‘ç»œå±‚</strong>ï¼ˆIPåè®®ï¼‰ï¼Œæœç´¢å¯¹æ–¹çš„åœ°å€åè½¬å‘ç»™<strong>é“¾è·¯å±‚</strong>ï¼› åŒæ ·çš„æœåŠ¡å™¨ç«¯æŒ‰ç…§å€’åºï¼Œç›´åˆ°æœåŠ¡ç«¯åº”ç”¨å±‚æ¥æ”¶é‡ç»„å‡ºHTTPæŠ¥æ–‡ï¼Œè¯·æ±‚æ‰ç®—æ¥å—å®Œæˆã€‚</p>
<h3 id="tcpçš„ç¡®ä¿å¯é æ€§">ğŸ“ŒTCPçš„ç¡®ä¿å¯é æ€§</h3>
<p>ç›¸æ¯”è¾ƒ<code>UDP</code>ä¸ºé¢å‘éè¿æ¥çš„åè®®ï¼Œ<code>TCP</code>åè®®åˆ™æ˜¯åœ¨å‘é€æ•°æ®å‰éœ€è¦å»ºç«‹å¯é çš„è¿æ¥ï¼›é€šå¸¸<code>TCP</code>åè®®é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹çš„ç­–ç•¥ä»¥åŠ<code>Flag</code>ï¼ˆ<code>SYN</code>ï¼Œ<code>ACK</code>ï¼‰æ ‡å¿—æ¥ä¿è¯é€šä¿¡çš„å¯é æ€§ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://pic.superbed.cn/item/5d9daa02451253d178972142.png" alt="ä¸‰æ¬¡æ¡æ‰‹" loading="lazy"></figure>
<ul>
<li>å‘é€ç«¯é¦–å…ˆå‘é€ä¸€ä¸ªå¸¦ <code>SYN</code> æ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹</li>
<li>æ¥æ”¶ç«¯æ”¶åˆ°åï¼Œå›ä¼ ä¸€ä¸ªå¸¦æœ‰ <code>SYN/ACK</code> æ ‡å¿—çš„æ•°æ®åŒ…ä»¥ç¤ºä¼ è¾¾ç¡®è®¤ä¿¡æ¯</li>
<li>æœ€åï¼Œå‘é€ç«¯å†å›ä¼ ä¸€ä¸ªå¸¦ <code>ACK</code> æ ‡å¿—çš„æ•°æ®åŒ…ï¼Œä»£è¡¨â€œæ¡æ‰‹â€ç»“æŸ</li>
</ul>
<p>è‹¥åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­æŸä¸ªé˜¶æ®µè«åä¸­æ–­ï¼Œ<code>TCP åè®®</code>ä¼šå†æ¬¡ä»¥ç›¸åŒçš„é¡ºåºå‘é€ç›¸åŒçš„æ•°æ®åŒ…ã€‚<br>
åŒæ—¶<code>TCP</code>åè®®å¯ä»¥æä¾›å­—èŠ‚æµæœåŠ¡ï¼Œè¿™æ ·å½“HTTPæŠ¥æ–‡ä¸»ä½“çš„æ•°æ®è¾ƒå¤§çš„æ—¶å€™ï¼Œæ›´æ˜“äºä¼ è¾“ï¼ˆä¾‹å¦‚ï¼šå¤§å›¾åŠ è½½çš„æ—¶å€™æ˜¯ä¸€å—ä¸€å—è¿›è¡ŒåŠ è½½ï¼‰</p>
<h3 id="ipåè®®-è·¯ç”±é€‰æ‹©åŠæ•°æ®ä¼ è¾“">ğŸ“ŒIPåè®® - è·¯ç”±é€‰æ‹©åŠæ•°æ®ä¼ è¾“</h3>
<p>ä½äºç½‘ç»œå±‚çš„<code>IP</code>åè®®çš„ä¸»è¦ä½œç”¨å°±æ˜¯å„ç§æ•°æ®åŒ…çš„ä¼ é€ï¼›</p>
<p><code>IP</code>åè®®ä¸æä¾›å¯é çš„ä¼ è¾“æœåŠ¡ï¼Œåªæ˜¯å°½è‡ªå·±æœ€å¤§åŠªåŠ›æ”¯ä»˜æ¥ä¼ è¾“æ•°æ®åŒ…ï¼Œå¯é æ€§ç”±ä¸Šå±‚åè®®æä¾›ï¼ˆ<code>TCP</code>åè®®ï¼‰ <code>IP</code>åè®®ä¹Ÿæ˜¯ä¸€ç§æ— è¿æ¥åè®®ï¼Œäº‹å…ˆä¸ä¼šå»ºç«‹ä¼šè¯ï¼›</p>
<h4 id="ipåœ°å€åŠmacåœ°å€">IPåœ°å€åŠMACåœ°å€</h4>
<p><code>IP</code> åœ°å€æŒ‡æ˜äº†èŠ‚ç‚¹è¢«åˆ†é…åˆ°çš„åœ°å€ï¼Œ<code>MAC</code> åœ°å€æ˜¯æŒ‡ç½‘å¡æ‰€å±çš„å›ºå®šåœ°å€ã€‚<code>IP</code> åœ°å€å¯ä»¥å’Œ <code>MAC</code> åœ°å€è¿›è¡Œé…å¯¹</p>
<p>ï¼Œä¾æ®<code>ARP</code>åè®®ï¼Œå¯ä»¥é€šè¿‡<code>IP</code>åœ°å€åæŸ¥å‡ºå¯¹åº”çš„<code>MAC</code>åœ°å€</p>
<h4 id="arpåè®®">ARPåè®®</h4>
<p><code>ARP</code> åŒæ ·ä¹Ÿæ˜¯ç½‘ç»œå±‚åè®®ï¼Œ<strong><u><em>å¯ä»¥é€šè¿‡ç›®æ ‡ä¸»æœºçš„IPåœ°å€ï¼ŒæŸ¥è¯¢è§£æç›®æ ‡ä¸»æœºçš„MACåœ°å€</em></u></strong>ï¼›ä¸­è½¬æ—¶åˆ©ç”¨ä¸‹ä¸€ç«™è®¾å¤‡çš„MACåœ°å€ç»§ç»­æœç´¢ä¸‹ä¸€ä¸ªä¸­è½¬å¯¹è±¡ï¼›</p>
<p>æ¯å°ä¸»æœºåœ¨è‡ªå·±çš„ARPç¼“å­˜åŒºä¸­éƒ½æœ‰ä¸€ä¸ªARPåˆ—è¡¨ï¼Œä¿å­˜äº†æ˜¯è¿‘æœŸä¸è‡ªå·±æœ‰è¿‡é€šä¿¡çš„ä¸»æœºçš„IPåœ°å€å’ŒMACåœ°å€ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚åœ¨è¿›è¡Œæ•°æ®ä¸­è½¬çš„æ—¶å€™ï¼Œå‘æœ¬ç½‘æ®µçš„æ‰€æœ‰ä¸»æœºå‘é€ä¸€ä¸ªæºå¸¦IPåœ°å€çš„ARPè¯·æ±‚æ•°æ®åŒ…ï¼Œæ”¶åˆ°åæŸ¥è¯¢è‡ªå·±çš„IPåœ°å€ï¼Œæ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼›</p>
<h2 id="http-åè®®åŠæŠ¥æ–‡ç®€è¿°">HTTP åè®®åŠæŠ¥æ–‡ç®€è¿°</h2>
<p><code>HTTP</code> åè®®è§„å®šåœ¨æ•°æ®ç”±å®¢æˆ·ç«¯å¼€å§‹å»ºç«‹é€šä¿¡ï¼Œè€ŒæœåŠ¡ç«¯æ²¡æœ‰è·å¾—è¯·æ±‚ä¹‹å‰ä¸ä¼šè¿›è¡Œå“åº”ï¼Œæ‰€ä»¥åœ¨ä¸€æ¡é€šä¿¡çº¿è·¯æ¥è¯´ï¼Œ<code>HTTP</code> åè®®å¯ä»¥æ˜ç¡®åŒºåˆ†å“ªä¸€ç«¯æ˜¯å®¢æˆ·ç«¯ï¼Œå“ªä¸€ç«¯æ˜¯æœåŠ¡ç«¯ã€‚</p>
<h3 id="http-åè®®çš„ç‰¹æ€§">ğŸ“HTTP åè®®çš„ç‰¹æ€§</h3>
<ul>
<li>
<p><strong>æ— çŠ¶æ€</strong></p>
<p><code>HTTP</code> åè®®ä¸ä¼šå¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„çŠ¶æ€åšå‡ºä¿å­˜ï¼Œå³ï¼šå¯¹äºå‘é€è¿‡çš„è¯·æ±‚å’Œå“åº”ä¸åšæŒä¹…åŒ–å¤„ç†ï¼ˆè¿™æ ·çš„è®¾è®¡æœ‰åˆ©äºå¿«é€Ÿçš„å¤„ç†å¤§é‡çš„äº‹åŠ¡ï¼‰ï¼Œåœ¨ <code>HTTP</code> 1.1 ä¸­å¯ä»¥å¯ä»¥é€šè¿‡ <code>cookie</code> è¿›è¡Œç®¡ç†çŠ¶æ€æ»¡è¶³ä¸šåŠ¡éœ€æ±‚</p>
</li>
<li>
<p><strong>æŒä¹…è¿æ¥</strong></p>
<p>åœ¨åˆå§‹çš„ <code>HTTP</code> åè®®ä¸­ï¼Œæ¯è¿›è¡Œä¸€æ¬¡ <code>HTTP</code> é€šä¿¡éœ€è¦æ–­å¼€ä¸€æ¬¡ <code>TCP</code> è¿æ¥ï¼Œä½†è¯·æ±‚åŒ…å«å¤šä¸ªå›¾ç‰‡çš„æ–‡æ¡£æ—¶å€™ï¼Œä¼šé¢‘ç¹æ–­å¼€ <code>TCP</code> è¿æ¥ï¼Œæ‰€ä»¥åœ¨åæœŸçš„ç‰ˆæœ¬ä¸­ï¼ˆ1.0 éƒ¨åˆ†åŠ 1.1 ä¹‹åï¼‰é‡‡ç”¨äº†æŒä¹…è¿æ¥çš„æ–¹æ³•ã€‚ å…¶ç‰¹ç‚¹æ˜¯ï¼š åªè¦ä»»æ„ä¸€ç«¯æ²¡æœ‰æ˜ç¡®çš„æå‡ºæ–­å¼€è¿æ¥åˆ™ç»§ç»­ä¿æŒ <code>TCP</code> çš„è¿æ¥çŠ¶æ€</p>
</li>
<li>
<p><strong>ç®¡çº¿åŒ–</strong></p>
<p>å› ä¸ºæŒä¹…è¿ä½¿å¾—å¤šæ•°è¯·æ±‚å¯ä»¥ä»¥ç®¡çº¿åŒ–çš„æ–¹å¼è¿›è¡Œå‘é€è¯·æ±‚ï¼Œä½¿å¾—å¯ä»¥ä¸ç”¨ç­‰å¾…ä¸€ä¸ªè¯·æ±‚å®Œæˆå°±å¯ä»¥ç»§ç»­å‘é€ï¼Œå¯ä»¥åšåˆ°**<u>å¹¶è¡Œå‘é€</u>**å¤šä¸ªè¯·æ±‚ã€‚ ä½¿ç”¨ç®¡çº¿åŒ–çš„æ–¹å¼å¯ä»¥ä½¿å¾—è¯·æ±‚æ›´å¿«çš„ç»“æŸï¼Œè¯·æ±‚æ•°ç›®è¶Šå¤šï¼Œæ—¶é—´å·®è¶Šæ˜æ˜¾ï¼›</p>
</li>
<li>
<p><strong>åŸºäº <code>Cookie</code> çš„çŠ¶æ€ç®¡ç†</strong></p>
<p>ç”±äº <code>HTTP</code> åè®®ä¸ºäº†å‡å°‘æœåŠ¡å™¨åŠå†…å­˜çš„æ¶ˆè€—è¢«è®¾è®¡ä¸ºæ— çŠ¶æ€ï¼Œä½†æ˜¯å„ç§ä¸šåŠ¡ä¸­åˆ™éœ€è¦ä¿å­˜ç™»å½•çŠ¶æ€ç­‰éœ€æ±‚ï¼Œäºæ˜¯å¼•å…¥äº† <code>Cookie</code> æŠ€æœ¯ã€‚</p>
<p><code>Cookie</code> æŠ€æœ¯é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥ <code>cookie</code> ä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚<code>Cookie</code> ä¼šæ ¹æ®ä»æœåŠ¡å™¨ç«¯å‘é€çš„å“åº”æŠ¥æ–‡å†…çš„ä¸€ä¸ªå«åš <code>Set-Cookie</code> çš„é¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜ <code>Cookie</code>ã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯å†å¾€è¯¥æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥ <code>Cookie</code> å€¼åå‘é€å‡ºå»ã€‚</p>
<p>å½“åœ¨ <code>cookie</code> ä¸­è®¾ç½®äº† <code>HttpOnly</code> å±æ€§ï¼Œé‚£ä¹ˆé€šè¿‡ js è„šæœ¬å°†æ— æ³•è¯»å–åˆ° <code>cookie</code> ä¿¡æ¯ï¼Œè¿™æ ·èƒ½æœ‰æ•ˆçš„é˜²æ­¢  <code>XSS</code> æ”»å‡»ã€‚</p>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å‰åç«¯åä½œ -- åŸºäº JWT å®ç°ç™»å½•æ³¨å†ŒåŠé‰´æƒ]]></title>
        <id>https://toxicfy.github.io/post/vue-koa2-login-regisiter</id>
        <link href="https://toxicfy.github.io/post/vue-koa2-login-regisiter">
        </link>
        <updated>2019-07-19T06:05:40.000Z</updated>
        <summary type="html"><![CDATA[<p>å› ä¸ºå…¬å¸çš„æœåŠ¡ç«¯æ˜¯ <code>C#</code>, ä¹‹å‰å¿«é€Ÿå¼€å‘çš„åº”ç”¨ä½¿ç”¨å‰åç«¯è€¦åˆå¼€å‘ï¼›ç”±äºç›®å‰é¡¹ç›®å·²ç»å‰åç«¯åˆ†ç¦»å¼€å‘ã€‚<br>
è¿™é‡Œé€šè¿‡ä¸€ä¸ªåŸºäº <strong><code>Vueå…¨å®¶æ¡¶</code> + <code>koa2</code> +<code>MongoDB</code></strong> å®Œæˆæ³¨å†Œã€ç™»å½•åŠŸèƒ½å¹¶ä½¿ç”¨<code>token</code> è®¤è¯çš„æ–¹å¼è¿›è¡Œæƒé™æ§åˆ¶ï¼Œä»¥ä¾¿äºäº†è§£å‰åç«¯åˆ†ç¦»çš„æ•°æ®äº¤äº’</p>
]]></summary>
        <content type="html"><![CDATA[<p>å› ä¸ºå…¬å¸çš„æœåŠ¡ç«¯æ˜¯ <code>C#</code>, ä¹‹å‰å¿«é€Ÿå¼€å‘çš„åº”ç”¨ä½¿ç”¨å‰åç«¯è€¦åˆå¼€å‘ï¼›ç”±äºç›®å‰é¡¹ç›®å·²ç»å‰åç«¯åˆ†ç¦»å¼€å‘ã€‚<br>
è¿™é‡Œé€šè¿‡ä¸€ä¸ªåŸºäº <strong><code>Vueå…¨å®¶æ¡¶</code> + <code>koa2</code> +<code>MongoDB</code></strong> å®Œæˆæ³¨å†Œã€ç™»å½•åŠŸèƒ½å¹¶ä½¿ç”¨<code>token</code> è®¤è¯çš„æ–¹å¼è¿›è¡Œæƒé™æ§åˆ¶ï¼Œä»¥ä¾¿äºäº†è§£å‰åç«¯åˆ†ç¦»çš„æ•°æ®äº¤äº’</p>
 <!-- more -->
<h2 id="åŸºæœ¬æ€è·¯">åŸºæœ¬æ€è·¯</h2>
<blockquote>
<p>å‰ç«¯é¡µé¢æ„å»ºå®Œæˆåï¼Œé€šè¿‡å°è£…äº†æ‹¦æˆªå™¨çš„ <code>axios</code> è¿›è¡Œæ•°æ®è¯·æ±‚ç”± <code>koa2</code>æä¾›çš„ <code>api</code> æ¥å£ã€‚ æ³¨å†Œå®Œæˆåç™»å½•æ—¶ï¼ŒæœåŠ¡ç«¯è¿›è¡Œæ•°æ®æ ¡éªŒåè¿”å›æˆåŠŸå¹¶æºå¸¦ <code>token</code>ï¼Œå‰ç«¯è¿›è¡Œ <code>token</code> çš„å­˜å‚¨;</p>
</blockquote>
<blockquote>
<p>é™¤äº†é™æ€æ•°æ®ä»¥åŠç™»å½•æ³¨å†Œï¼Œå…¶ä»–æ¥å£çš„è®¿é—®å‡éœ€è¦ <code>Header</code> æºå¸¦ <code>token</code>å€¼ï¼Œä»¥ä¾¿äºæœåŠ¡ç«¯è¿›è¡Œ <code>token</code> æ ¡éªŒåè¿”å›éœ€è¦çš„æ•°æ®, è¿›è€Œå®Œæˆæ•°æ®äº¤äº’</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://ae01.alicdn.com/kf/HTB14xWWaKP2gK0jSZFo761uIVXaK.png" alt="" loading="lazy"></figure>
<h2 id="å‰ç«¯å®ç°">å‰ç«¯å®ç°</h2>
<hr>
<p>å…³äºé¡µé¢çš„å®ç°æ•°æ®æäº¤è·å–ä»¥åŠ <code>Vuex</code> çš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸è¿›è¡Œä»‹ç»ï¼›å‰ç«¯éƒ¨åˆ†ä¸»è¦è®°å½•è·¯ç”±éƒ¨åˆ†çš„æ§åˆ¶å’Œ <code>axios</code> æ‹¦æˆªçš„å®ç°</p>
<h3 id="è·¯ç”±æ§åˆ¶æ‹¦æˆª">è·¯ç”±æ§åˆ¶/æ‹¦æˆª</h3>
<blockquote>
<p>å®ç°æ–¹å¼</p>
</blockquote>
<ol>
<li>
<p>å®šä¹‰ <code>router</code> è·¯ç”±é…ç½®é‡Œé¢çš„ <code>meta</code> å­—æ®µç¡®å®šè¯¥è·¯ç”±éœ€è¦<strong>ç™»å½•æƒé™</strong>ï¼›</p>
</li>
<li>
<p>é€šè¿‡ <code>vue-router</code> æä¾›çš„å¯¼èˆªå®ˆå«å®Œæˆæˆ‘ä»¬éœ€è¦çš„è·¯ç”±æ‹¦æˆª ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯å…¨å±€å®ˆå«çš„ <code>beforeEach</code>ã€‚</p>
<p>PS : <strong>å¯¼èˆªå®ˆå«</strong>å®é™…æ˜¯å¯¹åº”çš„è·¯ç”±è¡Œä¸ºæ—¶è§¦å‘æ—¶æ‰§è¡Œçš„é’©å­å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>next()</code> æ–¹æ³•é˜»æ­¢/æ”¹å˜æ­¤æ¬¡è·¯ç”±è¡Œä¸ºï¼›</p>
</li>
<li>
<p>è·¯ç”±åœ¨å®Œæˆè·³è½¬å‰éƒ½æ˜¯å¤„äº <strong>waiting</strong> ï¼ˆç­‰å¾…ï¼‰çš„çŠ¶æ€ï¼Œè€Œåœ¨ä¸€ä¸ªå®ˆå«é‡Œï¼š <code>next()</code> æ–¹æ³•çš„è°ƒç”¨ä¾¿æ˜¯ä¸ºäº† <code>resolve</code> å½“å‰çš„é’©å­ï¼Œå½“å…¨éƒ¨é’©å­æ‰§è¡Œå®Œæˆï¼Œæ­¤æ—¶è·¯ç”±å˜ä¸º <strong>confirmed</strong> ï¼ˆç¡®è®¤ï¼‰çŠ¶æ€</p>
</li>
</ol>
<pre><code class="language-javascript">import Vue from 'vue'
import Router from 'vue-router'
import Login from './views/user/Login'
import Register from './views/user/Register'
import Manage from './views/user/Manage'
import store from './store'

Vue.use(Router)

// å®šä¹‰routes é…ç½®
const routes = [
  {
    path: '/login',
    name: 'login',
    component: Login,
    meta: {
      title: 'ç™»å½•'
    }
  },
  {
    path: '/manage',
    name: 'manage',
    component: Manage,
    meta: {
      title: 'ç®¡ç†',
      requireAuth: true //å®šä¹‰requireAuthå­—æ®µç¡®å®šè¯¥è·¯ç”±éœ€è¦ç™»å½•æƒé™
    }
  },
  {
    path: '/register',
    name: 'register',
    component: Register,
    meta: {
      title: 'æ³¨å†Œ'
    }
  }
]

const router = new Router({ routes })

//é¡µé¢è¿›è¡Œåˆ·æ–°åï¼Œé‡æ–°èµ‹å€¼ store.user.token
if (localStorage.getItem('token')) {
  store.commit({
    type: 'SET_TOKEN',
    token: localStorage.getItem('token')
  })
}

// é¡µé¢è·³è½¬æƒé™æ§åˆ¶
router.beforeEach((to, from, next) =&gt; {
  // é¡µé¢éœ€è¦ç™»å½•æƒé™
  if (to.meta.requireAuth) {
    if (store.getters.token) {
      next()
    } else {
      // token æ— æ•ˆï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µ
      Vue.prototype.$message({
        type: 'warning',
        message: 'è®¤è¯è¿‡æœŸï¼Œéœ€è¦é‡æ–°ç™»å½•'
      })
      next({
        path: '/login',
        query: { redirect: to.fullPath }
      })
    }
  } else {
    next()
  }
})

export default router
</code></pre>
<h2 id="axios-å°è£…">Axios å°è£…</h2>
<blockquote>
<p>å®ç°æ–¹å¼</p>
</blockquote>
<ul>
<li>ä½¿ç”¨ <code>axios</code> çš„æ‹¦æˆªå™¨ï¼Œç»Ÿä¸€å¤„ç†æ‰€æœ‰<code>http</code>è¯·æ±‚å’Œå“åº”ï¼›</li>
<li>åœ¨éœ€è¦æƒé™çš„éƒ¨åˆ†ï¼Œå‘èµ·è¯·æ±‚æ—¶å€™ç»™ <code>Header</code> æ·»åŠ  <code>token</code>ï¼Œå¤„ç†è¿”å›çš„ä¿¡æ¯æ—¶å€™ï¼Œå½“è¿”å› <code>401</code>æœªæˆæƒæ—¶å€™ï¼Œä¿¡æ¯æ¸…é™¤å¹¶è¿›è¡Œè·³è½¬</li>
</ul>
<pre><code class="language-javascript">import axios from 'axios'
import store from './store'
import * as type from './store/constant'
import router from './router'

axios.defaults.baseURL = 'http://localhost:3000/api/'
axios.defaults.headers['Content-Type'] = 'application/json'

// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨
axios.interceptors.request.use(
  config =&gt; {
    // å¦‚æœå­˜åœ¨tokençš„è¯ï¼Œåˆ™æ¯ä¸ªhttp headeréƒ½åŠ ä¸Š
    if (localStorage.getItem('token')) {
      config.headers.Authorization = `Bearer ${store.getters.token}`
    }
    return config
  },
  err =&gt; {
    return Promise.reject(err)
  }
)

axios.interceptors.response.use(
  //åœ¨åç«¯ä¸ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å›å¯¹åº”çš„çŠ¶æ€ç ï¼Œè¿™æ ·æˆ‘ä»¬ä¾æ—§åœ¨responseéƒ¨åˆ†è¿›è¡Œå¤„ç†
  response =&gt; {
    if (response.data &amp;&amp; response.data.status) {
      switch (response.data.status) {
        case 401:
          store.commit(type.REMOVE_TOKEN)
          const currentRouter = router.currentRoute.path
          currentRouter !== 'login' &amp;&amp;
            router.push({
              path: 'login'
            })
          break

        default:
          break
      }
    }
    return response
  },
  err =&gt; {
    return new Promise.reject(err.response.data)
  }
)

export default axios
</code></pre>
<h2 id="åç«¯éƒ¨åˆ†">åç«¯éƒ¨åˆ†</h2>
<p>åç«¯éƒ¨åˆ†å®é™…ä¸ŠåŒæ ·å¹¶ä¸å¤æ‚ï¼Œå…³äº <code>mongoose</code>çš„<code>model</code>çš„å®šä¹‰ä»¥åŠ <code>koa2</code> ä¸å…¶çš„äº¤äº’ä¹Ÿæ˜¯ä¸æ‰“ç®—æŒªåˆ—ï¼Œä¸»è¦æè¿° <code>Token</code> çš„ç”ŸæˆéªŒè¯ä»¥åŠå¯¹åº”<code>koa2</code>çš„é…åˆï¼›</p>
<h3 id="jwt-è®¤è¯">JWT è®¤è¯</h3>
<blockquote>
<p>å®ç°æ–¹å¼</p>
</blockquote>
<ol>
<li>å®¢æˆ·ç«¯ç™»å½•é¡µè¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œå‘é€è¯·æ±‚ç»™åç«¯ (ä½¿ç”¨çš„æ˜¯æ˜æ–‡ï¼Œè¿™ä¸ªæ—¶å€™ <code>https</code> å°±å¾ˆé‡è¦äº†ï¼Œsad~)</li>
<li>å®¢æˆ·ç«¯ <code>koa2</code> è·å–å¹¶è§£æåˆ°å†…å®¹ï¼Œå¯†ç ä½¿ç”¨ <code>bcrypt</code> è¿›è¡Œæ ¡éªŒï¼›å¦‚æœç¬¦åˆï¼Œå°±ä¸‹å‘ä¸€ä¸ª <code>token</code> è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¦åˆ™è¿”å›éªŒè¯é”™è¯¯ä¿¡æ¯ã€‚</li>
<li>ç™»å½•æˆåŠŸåï¼Œå®¢æˆ·ç«¯å°†<code>token</code>ç”¨ä½¿ç”¨<code>localStorage</code>,å¹¶èµ‹å€¼ç»™<code>vuex</code>è¿›è¡Œå­˜å‚¨ï¼Œä¹‹åè¦è¯·æ±‚å…¶ä»–èµ„æºçš„æ—¶å€™ï¼Œåœ¨è¯·æ±‚å¤´é‡Œå¸¦ä¸Šè¿™ä¸ª<code>token</code>è¿›è¡Œè¯·æ±‚ã€‚</li>
<li>åç«¯æ”¶åˆ°è¯·æ±‚ä¿¡æ¯ï¼Œå…ˆéªŒè¯ä¸€ä¸‹<code>token</code>æ˜¯å¦æœ‰æ•ˆï¼Œæœ‰æ•ˆåˆ™ä¸‹å‘è¯·æ±‚çš„èµ„æºå¦åˆ™è¿”å›<code>401</code></li>
</ol>
<ul>
<li>ä½¿ç”¨<code>jsonwebtoken</code>å®Œæˆ<code>token</code>çš„åˆ›å»ºä»¥åŠç¼–å†™éªŒè¯<code>token</code>çš„ä¸­é—´ä»¶</li>
</ul>
<pre><code class="language-javascript">// createToken.js
const jwt = require('jsonwebtoken')
const { PRIVATE_KEY } = require('./key')

module.exports = id =&gt; {
  // jwtç­¾å‘tokenï¼Œä¸»ä½“ä¿¡æ¯å’Œç§˜é’¥æ˜¯å¿…é¡»çš„
  const token = jwt.sign(
    {
      id,
      exp: Math.floor(Date.now() / 1000) + 60 * 60
    },
    PRIVATE_KEY
  )
  return token
}

// validateToken.js
const jwt = require('jsonwebtoken')
const { PRIVATE_KEY } = require('./key')
const User = require('../dbs/userModels').Users

module.exports = async (ctx, next) =&gt; {
  const authorization = ctx.get('Authorization')
  if (!authorization) {
    ctx.throw(401)
  }
  // jwt éªŒè¯
  jwt.verify(
    authorization.split(' ').pop(), // header Authä¸ºç©ºæ ¼åˆ†å‰²çš„å­—ç¬¦ä¸²
    PRIVATE_KEY,
    async (err, decoded) =&gt; {
      if (err) {
        ctx.throw(401) //æœ‰ä¸€ä¸ªå…¨å±€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œå¤„ç†åå†å‘ç»™å‰ç«¯
      } else {
        // åˆ©ç”¨ctxä½œä¸ºæ•°æ®ä¼ é€’ï¼Œä¸ºäº†åç»­çš„koa2 ä¸­é—´ä»¶è·å–åˆ°_id
        ctx.id = decoded.id
      }
    }
  )
  await next()
}
</code></pre>
<ul>
<li><code>koa2</code> æä¾›ç”¨æˆ·çš„æ³¨å†Œå’Œç™»å½•é€»è¾‘<code>API</code>ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨<code>jwt</code>çš„éªŒè¯ï¼Œåªéœ€è¦åœ¨å¤„ç†å‡½æ•°ä¹‹å‰ä½¿ç”¨<code>validateToken</code>ä¸­é—´ä»¶è¿›è¡Œå¤„ç†å³å¯</li>
</ul>
<pre><code class="language-javascript">const Router = require('koa-router')
const User = require('../dbs/userModels').Users
const createToken = require('../token/createToken')
const validateToken = require('../token/validateToken')
const router = new Router()

// ç”¨æˆ·æ³¨å†Œé€»è¾‘
router.post('/api/register', async ctx =&gt; {
  const { username, password } = ctx.request.body
  const isRegister = await User.find({ username })
  if (isRegister.length &gt; 0) {
    ctx.body = {
      code: -1,
      message: 'è¯¥ç”¨æˆ·åå·²è¢«æ³¨å†Œ'
    }
    return
  }
  const user = await User.create({
    username,
    password
  })
  if (user) {
    ctx.body = {
      message: 'ç”¨æˆ·æ³¨å†ŒæˆåŠŸ',
      code: 0
    }
  } else {
    ctx.body = {
      message: 'ç”¨æˆ·æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•',
      code: -1
    }
  }
})

// ç”¨æˆ·ç™»å½•é€»è¾‘
router.post('/api/login', async ctx =&gt; {
  const { username, password } = ctx.request.body
  // éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨
  const user = await User.findOne({ username })
  if (!user) {
    return (ctx.body = {
      message: 'ç”¨æˆ·åä¸å­˜åœ¨',
      code: -1
    })
  }
  // éªŒè¯å¯†ç  &amp;&amp; ç”Ÿæˆtokenå¹¶ä¸‹å‘
  const isPasswordValid = require('bcrypt').compareSync(password, user.password)
  if (isPasswordValid) {
    const token = createToken(user._id)
    ctx.body = {
      token: token,
      message: 'ç™»å½•æˆåŠŸ',
      code: 0
    }
  }
})

module.exports = {
  router
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[é¡¹ç›®ç»´æŠ¤ -- å†å²è¿å»ºå¤„ç†æ¨¡å—]]></title>
        <id>https://toxicfy.github.io/post/historyIllegale</id>
        <link href="https://toxicfy.github.io/post/historyIllegale">
        </link>
        <updated>2019-05-09T08:26:58.000Z</updated>
        <summary type="html"><![CDATA[<p>è¿™æ˜¯é¡¹ç›®ç»´æŠ¤æœŸä¸­éœ€è¦æ·»åŠ çš„åŠŸèƒ½æ¨¡å—ï¼šå…¶å®å¯ä»¥ç®—æ˜¯åœ¨åŸæœ‰çš„ç³»ç»Ÿä¸Šæ·»åŠ ä¸€ä¸ªå°å‹çš„ç®¡ç†ç³»ç»Ÿäº†ï¼›è¿™é‡Œä»æ–‡ä»¶ä¸Šä¼ ã€iframeé¡µé¢æ•°æ®è®¿é—®ï¼Œæ•°æ®æ¸²æŸ“éƒ¨åˆ†æ€»ç»“ä¸€ä¸‹ï¼›</p>
]]></summary>
        <content type="html"><![CDATA[<p>è¿™æ˜¯é¡¹ç›®ç»´æŠ¤æœŸä¸­éœ€è¦æ·»åŠ çš„åŠŸèƒ½æ¨¡å—ï¼šå…¶å®å¯ä»¥ç®—æ˜¯åœ¨åŸæœ‰çš„ç³»ç»Ÿä¸Šæ·»åŠ ä¸€ä¸ªå°å‹çš„ç®¡ç†ç³»ç»Ÿäº†ï¼›è¿™é‡Œä»æ–‡ä»¶ä¸Šä¼ ã€iframeé¡µé¢æ•°æ®è®¿é—®ï¼Œæ•°æ®æ¸²æŸ“éƒ¨åˆ†æ€»ç»“ä¸€ä¸‹ï¼›</p>
<!-- more -->
<h1 id="æ•°æ®æ¸²æŸ“">æ•°æ®æ¸²æŸ“</h1>
<h3 id="åœ°å›¾åŒºåŸŸçº¿æ¡ç»˜åˆ¶">åœ°å›¾åŒºåŸŸçº¿æ¡ç»˜åˆ¶</h3>
<p>åœ¨ç¼–è¾‘çš„æ—¶å€™ä»æœåŠ¡ç«¯è¯·æ±‚åˆ°çš„ç‚¹åæ ‡é›†åˆåœ¨åœ°å›¾æ¸²æŸ“ï¼Œå’Œæ–°å¢å…±ç”¨ä¸€ä¸ªåœ°å›¾ï¼› ä½†æ˜¯æ“ä½œé€»è¾‘ä¸åŒï¼Œåœ¨æ–°å¢æ˜¯é ç‚¹å‡»äº‹ä»¶è§¦å‘åŠ è½½ï¼ˆç¬¬ä¸€æ¬¡ä¸ºåŠ è½½ï¼Œä¹‹åä¸ºæ˜¾ç¤ºéšè—ï¼‰ï¼Œç¼–è¾‘éœ€è¦ç›´æ¥æ¸²æŸ“ï¼›</p>
<pre><code class="language-javascript">$('#historyIllegaleModal').modal('show');

$('#historyIllegaleModal').on('shown.bs.modal', e =&gt; {
  if (vm.state === 'Edit') {
    if (!viewer) {
      vm.initWebGl(); //åˆå§‹åŠ è½½
    }

    $.extend(vm.commitData, data); // ä¾æ®æœåŠ¡ç«¯è¿›è¡Œæ•°æ®æ›¿æ¢
    vm.initChooseHistoryIllegaleArea(); // æ˜¾ç¤º canvas éƒ¨åˆ†
      
    //åŠ è½½å®Œæˆçš„å›è°ƒ
    viewer.onEndFrame = () =&gt; { 
      if (historyIllegaleTableEditState) {
        drawMeshLine(data['XQWZ']); //è°ƒç”¨ç»˜åˆ¶çš„æ–¹æ³•
        historyIllegaleTableEditState = false; 
      }
    }
    historyIllegaleTableEditState = true; //å…ˆæ‰§è¡Œ
  }
})
</code></pre>
<h3 id="å«ç‰‡å¯¹æ¯”åŒºåŸŸæ¸²æŸ“">å«ç‰‡å¯¹æ¯”åŒºåŸŸæ¸²æŸ“</h3>
<p>åœ¨è§¦å‘å«ç‰‡å¯¹æ¯”åŠŸèƒ½ä¸­ä¸­ä¾æ®ä¸»é¡µé¢é€‰ä¸­éœ€è¦æ¸²æŸ“çš„ç±»å‹ï¼Œå…¶ä¸­ç»˜åˆ¶è¡Œæ”¿åŒºåˆ’éƒ¨åˆ†ï¼ˆä¸ºæ–‡å­—æ ‡æ³¨å’ŒåŒºåŸŸåˆ’åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼‰;</p>
<figure data-type="image" tabindex="1"><img src="https://toxicfy.github.io//post-images/1557892099842.png" alt="process" loading="lazy"></figure>
<blockquote>
<p>æ„å»ºæ ‡æ³¨å›¾å±‚</p>
</blockquote>
<pre><code class="language-javascript">  let shapeCommonConfig = {
    width: &quot;76px&quot;,
    height: &quot;24px&quot;,
    padding: &quot;0&quot;,
    borderRadius: &quot;2px&quot;,
    color: &quot;#ff0000&quot;,
    opacity: 1,
    backgroundColor: &quot;none&quot;,
    fontWeight: &quot;900&quot;,
  };

  let shapeArr = [streetShape, streetShapeRight, communityShape, communityShapeRight, jurisdictionShape, jurisdictionShapeRight];
  shapeArr.forEach((shapeArrItem, index) =&gt; {
    shapeArrItem = new CSS2DLabelLayer();  
    Object.assign(shapeArrItem.css2DStyle, shapeCommonConfig);
    index % 2 === 0 ? sceneRight.addCustomLayer(shapeArrItem) : sceneLeft.addCustomLayer(shapeArrItem);
  })
</code></pre>
<blockquote>
<p>åˆ©ç”¨æ•°æ®é›†åˆæ¸²æŸ“å‡ºè¾¹ç•Œçº¿å’Œå…¶ä¸­çš„æ–‡å­—</p>
</blockquote>
<pre><code class="language-javascript">  // è¾¹ç•Œçº¿ &amp;&amp; æ–‡å­— æ·»åŠ 
  CITY_SHAPE_DATA.forEach((ele, curNum) =&gt; {
    // æ ¹æ®ä¸»é¡µ props ç¡®å®š é‚£äº›éœ€è¦åŠ è½½ï¼›
    let currentState = parent.document.querySelector(`#cityshapes${curNum}`).checked;
    if (!currentState) {
      return;
    }

    let sceneArr = [sceneRight, sceneLeft];
    for (let i = 0; i &lt; sceneArr.length; i++) {
      const item = sceneArr[i];
      var ftLayerPolygon = new tjh.ar.FeatureLayer(ele.url[0], &quot;&quot;, false, item.terrainLayers, item.globalOffset);
      ftLayerPolygon.loadAllOnce = true;
      // polygon
      ftLayerPolygon.regulator.isLoadFeature = true;// æ˜¯å¦åŠ è½½çŸ¢é‡streetSurface
      ftLayerPolygon.regulator.requestNum = 10;// æ¯å¸§åŠ è½½æ•°é‡
      ftLayerPolygon.regulator.color.set(Number(ele.setColor[0]));// çŸ¢é‡é¢œè‰²
      ftLayerPolygon.regulator.opacity = (ele.type === &quot;community&quot;) ? 0.5 : 1;// çŸ¢é‡é€æ˜åº¦
      ftLayerPolygon.regulator.size = 3.0;
      // çŸ¢é‡è´´åˆæ–¹å¼--äººå·¥æŒ‡å®šé«˜å±‚
      ftLayerPolygon.regulator.fitPattern = tjh.ar.FeatureLayer.FIT_PATTERN.FIT_TERRIAN_LOW;
      ftLayerPolygon.initMaterial();
      item.addFeatureLayer(ftLayerPolygon); //å‘å…¶ä¸­æ·»åŠ è¾¹ç•Œçº¿

      isRenderLabel = true; //è§¦å‘å°è£…åº“ä¸­çš„æ·»åŠ æ–¹æ³•

      let textConfig = [
        { type: &quot;street&quot;, target: streetShape, target2: streetShapeRight },
        { type: &quot;community&quot;, target: communityShape, target2: communityShapeRight },
        { type: &quot;jurisdiction&quot;, target: jurisdictionShape, target2: jurisdictionShapeRight }
      ];
      textConfig.forEach(element =&gt; {
        if (ele.type === element.type) {
          let { target, target2 } = element;
          for (let num = 0; num &lt; ele.centerPosition.length; num++) {
            const { name, x, y } = ele.centerPosition[num];
            target.addLabel(null, name, new THREE.Vector3(x, y, 50));
            target2.addLabel(null, name, new THREE.Vector3(x, y, 50));
          }
        }
      });
    }
  });

</code></pre>
<h3 id="vueæ•°æ®å“åº”å¼æ›´æ–°">Vueæ•°æ®å“åº”å¼æ›´æ–°</h3>
<p>ç”±äº Vue æ˜¯åœ¨åˆå§‹åŒ–å®ä¾‹æ—¶ï¼Œå°†å®ä¾‹å±æ€§æ‰§è¡Œ<code>getter/settter</code>å¯¹äºå·²ç»åˆ›å»ºçš„<code>vue</code>å®ä¾‹ä¸å…è®¸åŠ¨æ€æ·»åŠ è·Ÿçº§åˆ«çš„ç›¸åº”å¼å±æ€§ã€‚å› ä¸ºè¿™æ ·ä¸ä¼šè§¦å‘å˜åŒ–çš„ç›‘æ§ï¼Œæ‰€ä»¥è§†å›¾çš„æ›´æ–°æ— æ³•è‡ªåŠ¨åˆ·æ–°ï¼›</p>
<blockquote>
<p>ä½¿ç”¨ <code>Vue.set</code> æˆ–è€… <code>vm.$set</code>è¿è¡Œæ—¶å€™è¿›è¡ŒåŠ¨æ€æ·»åŠ ï¼›</p>
</blockquote>
<pre><code class="language-javascript">vm.$set(object,propertyName,value);// é€‚ç”¨äºåç«¯æ•°æ®è¿”å›åå¤„ç†æˆè‡ªå·±éœ€è¦çš„å±æ€§é›†åˆ
//eg: å‘æ¯ä¸ªitemæ·»åŠ è‡ªå®šä¹‰å±æ€§
this.posts =  res.map( item =&gt; {
    return { ...item, //somepropertyName }
})
</code></pre>
<blockquote>
<p>æ ¹èŠ‚ç‚¹æ•°æ®åˆå§‹åŒ–çš„æ—¶å€™å…¨éƒ¨æ·»åŠ </p>
</blockquote>
<pre><code class="language-javascript">data() {  // å½“å˜é‡å¾ˆå¤šçš„æ—¶å€™ï¼Œè€ƒè™‘åˆ†ç»„ååˆå¹¶ï¼Œé¿å…æ··ä¹±
  const userInfo = { //....
  };
  const config = { //....
  };
  return { ...userInfo, ...config, }
}
</code></pre>
<h1 id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </h1>
<blockquote>
<p>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ¶‰åŠåˆ° Post è¯·æ±‚ç”¨äºä¸Šä¼ æ–‡ä»¶ï¼Œï¼Œä½¿ç”¨ <code>FormData</code> è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼›</p>
</blockquote>
<pre><code class="language-html">&lt;!-- type=file ä»£è¡¨ä¸Šä¼ æ–‡ä»¶  --&gt;
&lt;!-- accept='' ä»£è¡¨ä¸Šä¼ æ–‡ä»¶é™åˆ¶ï¼Œè¿™é‡Œ .xls, .xlsx ä»£è¡¨é™å®šä¸º excelç±»å‹ --&gt;
&lt;input type=&quot;file&quot; name=&quot;&quot;  id=&quot;&quot; accept=&quot;.xls, .xlsx&quot; &gt;
</code></pre>
<p><code>FormData</code> å¯¹è±¡ç”¨ä»¥å°†æ•°æ®ç¼–è¯‘æˆé”®å€¼å¯¹ï¼Œä»¥ä¾¿ç”¨ <code>XMLHttpRequest</code> æ¥å‘é€æ•°æ®ï¼Œå…¶ä¸­å¦‚æœè¡¨å• <code>enctype</code> å±æ€§è®¾ä¸º <code>multipart/form-data</code> ï¼Œåˆ™ä¼šä½¿ç”¨è¡¨å•çš„ <code>submit()</code> æ–¹æ³•æ¥å‘é€æ•°æ®ï¼›</p>
<pre><code class="language-javascript">var formData = new FormData();

formData.append(&quot;name&quot;, &quot;tom&quot;);
formData.append(&quot;num&quot;, 123); //æ•°å­—123ä¼šè¢«ç«‹å³è½¬æ¢æˆå­—ç¬¦ä¸² &quot;123&quot;


// åœ¨jqä½¿ç”¨ - è®¾ç½®ä¸å¤„ç†æ•°æ®åŠå†…å®¹ç±»å‹å³å¯
var formData = new FormData(document.querySelector(&quot;form&quot;));
formData.append(&quot;file&quot;, fileInputElement.files[0]);
$.ajax({
  url: &quot;stash.php&quot;,
  type: &quot;POST&quot;,
  data: formData,
  processData: false,  // ä¸å¤„ç†æ•°æ®
  contentType: false   // ä¸è®¾ç½®å†…å®¹ç±»å‹
  success(res){},
});

</code></pre>
<p>åœ¨ vue æ¨¡æ¿é…åˆ axios ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<pre><code class="language-html">&lt;template&gt;
  &lt;div id=&quot;app&quot;&gt;
    &lt;input id=&quot;fileinput&quot; @change=&quot;uploading($event)&quot; type=&quot;file&quot; accept=&quot;image/*&quot;&gt;
    &lt;button @click.prevent=&quot;submit()&quot;&gt;&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: &quot;#app&quot;,
  data() {
    return { file: &quot;&quot;, src: &quot;&quot; };
  },
  methods: {
    uploading(event) {
      this.file = event.target.files[0]; //è·å–æ–‡ä»¶
      var windowURL = window.URL || window.webkitURL;
      this.file = event.target.files[0];
      this.src = windowURL.createObjectURL(event.target.files[0]);//åˆ›å»ºå›¾ç‰‡æ–‡ä»¶çš„url
    },

    submit() {
      let formdata = new FormData();
      formdata.append(&quot;file&quot;, this.file);
      let config = {//æ­¤å¤„å¿…é¡»è®¾ç½®ä¸º  multipart/form-data
        headers: {
          &quot;Content-Type&quot;: &quot;multipart/form-data&quot; //ä¹‹å‰è¯´çš„ä»¥è¡¨å•ä¼ æ•°æ®çš„æ ¼å¼æ¥ä¼ é€’fromdata
        }
      };

      this.$http.post(&quot;/upload&quot;, formData, config)
        .then(res =&gt; {
          //do something
        })
        .catch(error =&gt; {});
    }
  }
};
&lt;/script&gt;
</code></pre>
<h1 id="iframeé¡µé¢æ•°æ®è®¿é—®">iframeé¡µé¢æ•°æ®è®¿é—®</h1>
<blockquote>
<p>ç”±äºä¸‰ç»´åœ°å›¾æµè§ˆåŠŸèƒ½å’Œå…¶ä»–å¤§éƒ¨åˆ†é€»è¾‘æ— å…³ï¼Œæ‰€ä»¥æ”¾ç½®åœ¨ä¸€ä¸ªæ–°çš„ iframe ä¸­è¿›è¡Œä¸šåŠ¡é€»è¾‘ç¼–å†™ï¼› ä½†æ˜¯æ•°æ®è·å–ä¼ å…¥ä»¥åŠè°ƒç”¨ï¼Œéœ€è¦è°ƒç”¨æ–¹æ³•å’Œç»™å˜é‡èµ‹å€¼ï¼›</p>
</blockquote>
<pre><code class="language-html">&lt;!-- parent.html --&gt;
&lt;div class='iframeContainer'&gt;
  &lt;iframe src='' id='myIframe'&gt;
&lt;/div&gt;
</code></pre>
<pre><code class="language-javascript">//iframe.js
var testValue;  // å› ä¸ºæˆ‘ä»¬ä»ä¸»é¡µé¢è·å–çš„æ˜¯ window å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ var å£°æ˜å˜é‡ï¼Œä»¥ä¾¿äºç›´æ¥è¿›è¡Œè·å–ï¼›

function subFunction(){
  //do something
}


// parent.js
let childWindow = document.querySelector('#myIframe').contentWindows; //è·å–åˆ°å­é¡µé¢çš„ window å¯¹è±¡
childWindow.testValue = 'changed' ; //ä¿®æ”¹
childWindow.subFunction(); //æ‰§è¡Œå­é¡µé¢çš„æ–¹æ³•


// å¯¹äºå­é¡µé¢è®¿é—®çˆ¶é¡µé¢åˆ™æ˜¯å¯ä»¥é€šè¿‡`parent`å³å¯è®¿é—®åˆ°ï¼›
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[é¡¹ç›®æ€»ç»“ -- webArå»ºç­‘ç®¡ç†ç³»ç»Ÿ]]></title>
        <id>https://toxicfy.github.io/post/xiang-mu-zong-jie-webar-jian-zhu-guan-li-xi-tong</id>
        <link href="https://toxicfy.github.io/post/xiang-mu-zong-jie-webar-jian-zhu-guan-li-xi-tong">
        </link>
        <updated>2019-01-23T01:31:27.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>å…¶å®è¿™é‡Œæœ‰ç‚¹æ ‡é¢˜å…šçš„å«Œç–‘ï¼Œå…¶å®è¿™ä¸ªé¡¹ç›®åœ¨ä¸€æœˆåˆçš„æ—¶é—´å·²ç»å®Œæˆäº†ï¼Œå› ä¸ºæ˜¯ <code>webAr</code> é¡¹ç›®çš„åˆå§‹åº”ç”¨ï¼ˆæ²¡æœ‰ä½¿ç”¨æ‰“åŒ…å·¥å…·å’Œ cli ï¼‰ï¼ŒåŠ ä¸Šä¸šåŠ¡é€»è¾‘å¾ˆå¤æ‚ï¼Œæ‰€ä»¥è¿™é‡Œå®é™…ä¸Šæ˜¯åŸºäº <code>Vue-li</code>ä¸‹å¯¹äºé¡¹ç›®çš„æ€»ç»“</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>å…¶å®è¿™é‡Œæœ‰ç‚¹æ ‡é¢˜å…šçš„å«Œç–‘ï¼Œå…¶å®è¿™ä¸ªé¡¹ç›®åœ¨ä¸€æœˆåˆçš„æ—¶é—´å·²ç»å®Œæˆäº†ï¼Œå› ä¸ºæ˜¯ <code>webAr</code> é¡¹ç›®çš„åˆå§‹åº”ç”¨ï¼ˆæ²¡æœ‰ä½¿ç”¨æ‰“åŒ…å·¥å…·å’Œ cli ï¼‰ï¼ŒåŠ ä¸Šä¸šåŠ¡é€»è¾‘å¾ˆå¤æ‚ï¼Œæ‰€ä»¥è¿™é‡Œå®é™…ä¸Šæ˜¯åŸºäº <code>Vue-li</code>ä¸‹å¯¹äºé¡¹ç›®çš„æ€»ç»“</p>
</blockquote>
<!-- more --> 
<h3 id="é”™è¯¯-class-constructor-funname-cannot-be-invoked-without-new">é”™è¯¯ : <code>Class constructor FunName cannot be invoked without 'new'</code></h3>
<ul>
<li><strong>èµ·ç”±</strong>ï¼šç›´æ¥è°ƒç”¨çš„çˆ¶ç±»çš„æ—¶å€™æ— æ³•ä½¿ç”¨å­ç±»ç»§æ‰¿ï¼Œåªèƒ½é€šè¿‡ <code>new</code> çš„æ–¹å¼ï¼Œå³: æ— æ³•ä½¿ç”¨å·²è½¬æ¢çš„ç±»æ‰©å±•æœ¬æœºç±»</li>
<li><strong>æ–¹æ³•</strong>ï¼šä¿®æ”¹<code>.babelrc</code> - æ’é™¤ <code>transform-es2015-classes</code></li>
</ul>
<pre><code class="language-javascript">// &lt;!-- å‚è€ƒï¼šhttps://stackoverflow.com/questions/36577683/babel-error-class-constructor-foo-cannot-be-invoked-without-new --&gt;
presets: [
    [&quot;env&quot;, {
        exclude: [&quot;transform-es2015-classes&quot;]
    }]
]
</code></pre>
<h3 id="åŠŸèƒ½-æ·»åŠ -css2dlabel-è¿›è¡Œåœºæ™¯çš„ç‰¹æ®Šæ ‡æ³¨">åŠŸèƒ½ : æ·»åŠ  <code>css2DLabel</code> è¿›è¡Œåœºæ™¯çš„ç‰¹æ®Šæ ‡æ³¨</h3>
<ul>
<li><strong>èµ·ç”±</strong>: æ·»åŠ  <code>css2D</code> å±‚ <code>canvas</code> æ— æ³•ä½¿ç”¨å®šä¹‰å¥½çš„äº‹ä»¶ï¼›</li>
<li><strong>æ–¹æ³•</strong>ï¼šä¿®æ”¹ <code>css2D</code> çš„ <code>z-index</code> ï¼Œå¹¶éœ€è¦ä¼ é€’å·²å®šä¹‰çš„äº‹ä»¶</li>
</ul>
<pre><code class="language-javascript">is_render = true;

//åˆå§‹åŒ–css2DRender &amp;&amp; Dom style
let css2DRender = new THREE.CSS2DRenderer(viewer);
initCSS2DRender(css2DRenderer);

// èµ‹å€¼äº‹ä»¶ï¼Œæ·»åŠ Dom
css2DRender.domElement.ondbclick = () =&gt; {
    terrain.methods.dbFinishToolEvents
};
css2DRender.domElement.onclick = () =&gt; {
    terrain.methods.FinishToolEvents
};
document.getElementById(&quot;container&quot;).appendChild(css2DRenderer.domElement);

// åœºæ™¯æ›´æ–°
viewer.onEndRenderTechnique = () =&gt; {
    if (is_render) {
        css2DRenderer.render(scene, camera)
    }
}
</code></pre>
<h3 id="å…³äº-css2dlabellayer-çš„-addlabel-æ–¹æ³•çš„æ”¹å†™">å…³äº <code>css2DLabelLayer</code> çš„ <code>addLabel</code> æ–¹æ³•çš„æ”¹å†™:</h3>
<blockquote>
<p>é€šè¿‡ imgconfig å‚æ•°é…ç½®çš„ä¼ é€’ç”Ÿæˆ ImgIcon éƒ¨åˆ†</p>
</blockquote>
<pre><code class="language-javascript">// dom æ·»åŠ  imgIcon
labelDiv.appendChild(getCSS2DIcon(imgconfig));

/**
 * ç”Ÿæˆ ImgIcon
 * @param {Object} config - ç”¨äºç”Ÿæˆ ImgIcon çš„é…ç½®
 * @returns Image Dom
 */
function getCSS2DIcon(config) {
  let CSS2D_IMGCONFIG;
  config ? CSS2D_IMGCONFIG = config : CSS2D_IMGCONFIG = {
    src: '/static/img/position.gif',
    width: &quot;30px&quot;,
    height: &quot;40px&quot;,
    position: &quot;absolute&quot;,
    top: &quot;24px&quot;,
    left: &quot;32%&quot;
  };

  let imgIcon = new Image();
  imgIcon.src = CSS2D_IMGCONFIG.src;
  Object.assign(imgIcon.style, CSS2D_IMGCONFIG);

  return imgIcon;
}
</code></pre>
<pre><code class="language-javascript">//åœ¨åˆ›å»ºcss2DLayerçš„æ—¶ï¼šåˆ©ç”¨ dom ç”Ÿæˆ cssLabel
let cssLabel = new THREE.CSS2DObject(labelDiv);
cssLabel.heightRatio = 5; // è®¾å®š heightRatio (4-ä½¿ç”¨gifä¸­å¿ƒä¸ºæ—‹è½¬çš„ç‚¹)
this.add(cssLabel);  //æ­¤å¤„çš„thisæ˜¯ CSS2DLabelLayer ç±»
</code></pre>
<h3 id="åŠŸèƒ½åœ¨å¯¹canvasä¸Šè¿›è¡Œäº‹ä»¶ç›‘å¬çš„ç”¨äºæ»¡è¶³é€»è¾‘é€šå¸¸æ˜¯å·¥å…·ç±»çš„è‡ªåŠ¨å…³é—­">åŠŸèƒ½ï¼šåœ¨å¯¹canvasä¸Šè¿›è¡Œäº‹ä»¶ç›‘å¬çš„ç”¨äºæ»¡è¶³é€»è¾‘ï¼ˆé€šå¸¸æ˜¯å·¥å…·ç±»çš„è‡ªåŠ¨å…³é—­ï¼‰</h3>
<pre><code class="language-javascript">//Html Dom
// &lt;canvas id=&quot;canvasView&quot; @click=&quot;finishToolsEvent&quot; @dblclick=&quot;dbFinishToolsEvent&quot;&gt;&lt;/canvas&gt;

//JS methods
finishToolsEvent(timeout = 300){
  if(this.clickTimer){
      window.clearTimeout(this.clickTimer)ï¼›
      this.clickTimer = null;
  }

  this.clickTimer = window.setTimeOut(() =&gt; {
    // do something single click
  },timeout)
}ï¼Œ
dbFinishToolsEvent(){
	if (this.clickTimer) {
    window.clearTimeout(this.clickTimer);
      this.clickTimer = null;
  }
  //do something dbclick
}
</code></pre>
<h3 id="åŠŸèƒ½-å¯¹äºä¸€äº›åŠ è½½æ—¶é—´æ¯”è¾ƒä¹…çš„ç»„ä»¶ä¸å¸Œæœ›åŠŸèƒ½åˆ‡æ¢çš„æ—¶å€™çŠ¶æ€ä¸¢å¤±">åŠŸèƒ½ : å¯¹äºä¸€äº›åŠ è½½æ—¶é—´æ¯”è¾ƒä¹…çš„ç»„ä»¶ï¼Œä¸å¸Œæœ›åŠŸèƒ½åˆ‡æ¢çš„æ—¶å€™çŠ¶æ€ä¸¢å¤±ï¼›</h3>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šä½¿ç”¨<code>vue-router</code>çš„ <code>keep-alive</code> ä¿æŒåŠ è½½å®Œæˆçš„çŠ¶æ€ï¼›</li>
</ul>
<pre><code class="language-java">//vue component
&lt;keep-alive&gt;
     &lt;router-view v-if='$router.meta.keep_alive'&gt;&lt;/router-view&gt;
&lt;/keep-alive&gt;
&lt;router-view v-if='!$router.meta.keep_alive'&gt;&lt;/router-view&gt;
</code></pre>
<pre><code class="language-javascript">// router/index.js
export default new Router({
    route: [{
        // ....   
        children: [{
            path: './SatelliteImgContrast',
            component: resolve =&gt; require(['@components/satelliteImgContrast'], resolve),
            meta: {
                title: 'xx',
                keep_alive: true
            }
        }]
    }]
})
</code></pre>
<h3 id="åŸºäº-vuex-çš„æ•°æ®ç®¡ç†">åŸºäº Vuex çš„æ•°æ®ç®¡ç†</h3>
<p>ç”±äºè¿ç§»äº†è¾ƒå¤šçš„åŠŸèƒ½ï¼Œæ•´ä¸ªé¡¹ç›®æ•°æ®çŠ¶æ€è¾ƒå¤šï¼Œä½¿ç”¨äº†<code>Vuex</code>è¿›è¡Œæ•°æ®ç®¡ç†ï¼›</p>
<p><code>store</code> åœ¨ <code>Vue-cli</code>çš„ç»„ç»‡ç»“æ„å¦‚ä¸‹</p>
<pre><code>â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â”œâ”€â”€ components
â””â”€â”€ store
    â”œâ”€â”€ index.js          #  ç»„è£…æ¨¡å—å¹¶å¯¼å‡º store
    â”œâ”€â”€ state.js          #  state (å­˜å‚¨çŠ¶æ€)
    â”œâ”€â”€ getters.js        #  getter (æ´¾ç”ŸçŠ¶æ€)
    â”œâ”€â”€ mutation-types.js #  constant (çŠ¶æ€ä¿®æ”¹ç±»å‹)
    â”œâ”€â”€ mutations.js      #  mutation (æäº¤çŠ¶æ€ä¿®æ”¹)
    â”œâ”€â”€ actions.js        #  action (å¼‚æ­¥æ“ä½œ - æäº¤mutation)
</code></pre>
<p>å¯ä»¥æåŠä¸€ä¸‹çš„æ˜¯ï¼š</p>
<ul>
<li><code>mutation-type.js</code> æ˜¯å•ç‹¬å­˜æ”¾ <code>mutation</code> çš„ç±»å‹å­˜åœ¨çš„ï¼Œå’Œ <code>mutation</code> é…åˆä½¿ç”¨çš„</li>
</ul>
<p>Exampleï¼š</p>
<pre><code class="language-javascript">// mutation-type.js
export const SET_ALLLAYER_DATA = &quot;SET_ALLLAYER_DATA&quot;;
export const DEL_DREWLAYER_DATA = &quot;DEL_DREWLAYER_DATA&quot;;

// mutation.js
import * as types from './mutation-type.js';

export default {
    [types.SET_ALLLAYER_DATA](state, {name, data}) {
        state.layerData[name] = data;
    },
    [types.DEL_DREWLAYER_DATA](state, uuid) {
        state.layerData.forEach((ele, i, arr) =&gt; {
            if (ele.uuid === uuid) arr.splice(index, 1)
        })
    }
}

</code></pre>
<ul>
<li><code>action</code> æä¾›å¼‚æ­¥æ“ä½œï¼Œå¹¶æäº¤ <code>mutation</code></li>
</ul>
<p><code>action</code> ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æ˜¯å’Œ <code>store</code> å…·æœ‰ç›¸åŒå‚æ•°å±æ€§çš„å¯¹è±¡ã€‚å®é™…ä¸Š <code>action</code> ä¸å…·æœ‰ä¿®æ”¹ <code>state</code> çš„èƒ½åŠ›ï¼Œä¾æ—§é€šè¿‡æäº¤ï¼ˆè§¦å‘ï¼‰<code>mutation</code> å®ç°ä¿®æ”¹ï¼›</p>
<pre><code class="language-javascript">// store.dispatch(actionType)
// action.js
import * as types from './mutation-type.js';

export default {
  actionExample({ commit }, { uuid, name, data }) {
    commit(types.DEL_DREWLAYER_DATA, uuid);
    commit({ type: types.SET_ALLLAYER_DATA, name, data });
  }
};
</code></pre>
<ul>
<li>è¾…åŠ©å‡½æ•° <code>mapState/mapGetters/mapMutations/mapActions</code></li>
</ul>
<p>å½“éœ€è¦åœ¨ç»„ä»¶ä¸­å¼•ç”¨çš„æ–¹æ³•æˆ–è€…å±æ€§è¾ƒå¤šçš„æ—¶å€™æˆ‘ä»¬ä½¿ç”¨è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬å®ç°, å¯¹è±¡å±•å¼€è¿ç®—ç¬¦æŠŠæˆ‘ä»¬éœ€è¦çš„å±æ€§å’Œæ–¹æ³•æ˜ å°„åˆ°åˆ°å¯¹åº”çš„çˆ¶çº§ï¼ˆvueå±æ€§ï¼‰ï¼›</p>
<pre><code class="language-javascript">// å‡ ç§ä¸åŒçš„æ–¹å¼
import {mapGetters, mapMutations, mapActions} from 'vuex';
export default {
    computed: {
        ...mapGetters(['getLayerData','getDrawLayerData']),//åç§°ä¸ state çš„å­èŠ‚ç‚¹åç§°ç›¸åŒæ—¶
        ...mapState({
          excavateData: state =&gt; state.excavate.data
        })
    },
    methods: {
        ...mapMutations({
            setData: 'SET_ALLLAYER_DATA',//å¦å–ä¸€ä¸ªåå­—ï¼Œä½¿ç”¨å¯¹è±¡å½¢å¼
            deleteDrawData: 'DEL_DREWLAYER_DATA'
        }),
        ...mapActions([ actionExample ])
    }
};
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[é¡¹ç›®æ€»ç»“ -- æ™ºæ…§æ¡¥æ¢]]></title>
        <id>https://toxicfy.github.io/post/xiang-mu-zong-jie-zhi-hui-qiao-liang</id>
        <link href="https://toxicfy.github.io/post/xiang-mu-zong-jie-zhi-hui-qiao-liang">
        </link>
        <updated>2018-03-14T01:59:31.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>é¡¹ç›®ä¸­æ€»ç»“å‡ºä¸€äº›å¸¸è§é—®é¢˜ï¼Œé¡ºä¾¿ç†Ÿæ‚‰å¼€å‘ä¸­å‡ºç°çš„<code>API</code>ï¼›</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>é¡¹ç›®ä¸­æ€»ç»“å‡ºä¸€äº›å¸¸è§é—®é¢˜ï¼Œé¡ºä¾¿ç†Ÿæ‚‰å¼€å‘ä¸­å‡ºç°çš„<code>API</code>ï¼›</p>
</blockquote>
<!-- more --> 
<p>smartBridge's  tipsï¼š</p>
<h2 id="æ“ä½œiframeåç‚¹å‡»æ¨¡å‹åå‡ºç°çš„é—ªçƒé—®é¢˜">æ“ä½œiframeåç‚¹å‡»æ¨¡å‹åå‡ºç°çš„é—ªçƒé—®é¢˜</h2>
<blockquote>
<p>è§£å†³æ–¹æ³•ï¼š æ”¹å˜ç„¦ç‚¹äº‹ä»¶</p>
</blockquote>
<ol>
<li>
<p>åœ¨æ¨¡å‹é˜Ÿå½¢çš„htmlä¸ŠåŠ å…¥ <code>onmouseover=&quot;changeFocus()&quot;</code>ï¼›</p>
</li>
<li>
<p>jsä¸­å®šä¹‰å¹¶æ‰§è¡Œä¸€ä¸ªæ— æ„ä¹‰çš„ç‚¹å‡»æ“ä½œ</p>
<pre><code class="language-javascript"> function changeFocus() {
    $('.test').click();
 }
</code></pre>
</li>
</ol>
<!-- more -->
<h2 id="è§†å›¾ä¸­å®šä½æ–¹æ³•çš„å®ç°">è§†å›¾ä¸­å®šä½æ–¹æ³•çš„å®ç°</h2>
<blockquote>
<p>éœ€è¦å®šä½åˆ°çš„ä½ç½®åæ ‡(x,y,z)</p>
</blockquote>
<pre><code class="language-javascript">function position(x, y, z) {
    var vec3 = VirtualRealityCtrl.UtilManager.CreateInstance(&quot;Vertex&quot;);//åˆ›å»ºç—…å®³åæ ‡;
    vec3.X = x;
    vec3.Y = y;
    vec3.Z = z;
    var normalview = VirtualRealityCtrl.ViewerManager.GetView(0);  //æ‹¿åˆ°æ ‡å‡†è§†å›¾å¯¹è±¡
    normalview.SetPosition(vec3, 80, 1);//ä»¥æ ‡å‡†è§†å›¾çš„è§†è§’å®šä½åˆ°è§†å›¾çš„ä¸­å¿ƒç‚¹ï¼ˆåæ ‡ï¼Œé«˜åº¦ï¼Œè¿‡æ¸¡æ—¶é—´ï¼‰
}
</code></pre>
<h2 id="æ¤å…¥æ¨¡å‹åæ— æ³•é‡Šæ”¾å·¥å…·åå¤æ·»åŠ ">æ¤å…¥æ¨¡å‹åæ— æ³•é‡Šæ”¾å·¥å…·ï¼Œåå¤æ·»åŠ </h2>
<blockquote>
<p>ç»™å®šä¸€ä¸ªæ ‡è¯†çŠ¶æ€ï¼ˆç›®å‰ä¸çŸ¥é“ä¸ºä»€ä¹ˆåŠ äº†å°±å¯ä»¥äº†ï¼‰</p>
</blockquote>
<pre><code class="language-javascript">var flagModel = false;   //ç»™å®šä¸€ä¸ªçŠ¶æ€

{ 
  //æ¨¡å‹æ·»åŠ è§¦å‘äº‹ä»¶
  flagModel = true;
  //è·å–åˆ°æ¨¡å‹çš„url = ï¼Ÿï¼Ÿ
  VirtualRealityCtrl.ToolManager.ActiveTool = 5;    //åˆ‡æ¢ä¸ºç‚¹å‡»äº‹ä»¶
  VirtualRealityCtrl.attachEvent(&quot;ToolEvent&quot;, ToolEventAddModel); //aræ³¨å†Œäº‹ä»¶
}

function ToolEventAddModel(id, type, data) {
    var obj = JSON.parse(data);
    if (flagModel) {
        AR.Tool.AddModel(url, obj[1]); //obj[1]æ˜¯åæ ‡ä¿¡æ¯é›†åˆ
        flagModel = false;
    }
    if (obj.ID != &quot;&quot;) {
        VirtualRealityCtrl.ToolManager.ReleaseActiveTool(); //é‡Šæ”¾ç‚¹å‡»çš„çŠ¶æ€
    }
}
</code></pre>
<h2 id="è§†å›¾ä¸­æ·»åŠ æ¨¡å‹éç§æ¤çš„ä¸€äº›æ“ä½œ">è§†å›¾ä¸­æ·»åŠ &quot;æ¨¡å‹&quot;ï¼ˆéç§æ¤çš„ï¼‰ä¸€äº›æ“ä½œ</h2>
<blockquote>
<p>è¿™é‡Œç”¨æ™ºæ…§æ¡¥æ¢ä¸­çš„ç—…å®³ä¿¡æ¯ä¸ºä¾‹</p>
</blockquote>
<ul>
<li>åˆ›å»º</li>
</ul>
<blockquote>
<p>å®é™…ä¸Šç—…å®³çš„åˆ›å»ºæ˜¯åˆ›å»ºæ–‡æœ¬æ¨¡å‹</p>
</blockquote>
<pre><code class="language-javascript">var txt = VirtualRealityCtrl.ModelManager.CreateTextModelParam();
var vec3 = VirtualRealityCtrl.UtilManager.CreateInstance(&quot;Vertex&quot;);
vec3.X = x;
vec3.Y = y;
vec3.Z = z;
txt.Position = vec3;
txt.Text = t;
txt.ImagePath = basePath + imgUrl;
var mod = VirtualRealityCtrl.ModelManager.CreateTextModel(txt); //åˆ›å»ºä¼ æ„Ÿå™¨è¯´æ˜
mod.ShowDirScreen = true;                                       //æ˜¯å¦æ˜¾ç¤ºè¯´æ˜æ–‡å­—
VirtualRealityCtrl.LayerManager.ModelLayer.AddNode(mod);        //æ·»åŠ åˆ°å±•ç¤ºå±‚
arr.push({
    KeyId: item[i].KeyId,         //keyIDæ˜¯ç”¨äºéæ–‡æœ¬æ¨¡å‹æ“ä½œçš„æ ‡è¯†ï¼ˆä¾æ®æ­¤çš„è¯·æ±‚ç­‰ï¼‰
    ModId: mod.ID                 //mod.IDæ˜¯è·å–è¯¥æ–‡æœ¬æ¨¡å‹çš„æ ‡è¯†
});
</code></pre>
<ul>
<li>åˆ é™¤</li>
</ul>
<blockquote>
<p>ä¾èµ–äºåˆ›å»ºæ—¶ä¸‰ç»´è§†å›¾ä¸­çš„å”¯ä¸€æ ‡è¯†ID</p>
</blockquote>
<pre><code class="language-javascript">if (arr != null) {
    for (var i = 0; i &lt; arr.length; i++) {
        var model = VirtualRealityCtrl.LayerManager.GetModelNodeByID(arr[i].ModId);
        if (model != null) {
            VirtualRealityCtrl.LayerManager.ModelLayer.DeleteNode(model);
        }
    }
    arr = [];
}
</code></pre>
<ul>
<li>ä¾æ®è‡ªå®šä¹‰<code>iD</code>å­—æ®µè¯·æ±‚</li>
</ul>
<blockquote>
<p>åœ¨æ³¨å†Œäº‹ä»¶ä¸­è¿›è¡Œåˆ¤æ–­å½“å‰æ“ä½œçš„æ–‡æœ¬æ¨¡å‹æ˜¯å“ªä¸€ä¸ª<code>mod.id</code>ï¼Ÿï¼Ÿ ç„¶åé€šè¿‡è¿™ä¸ªå†æ‹¿åˆ°<code>keyId</code>å‘èµ·ç½‘ç»œè¯·æ±‚</p>
</blockquote>
<pre><code class="language-javascript">VirtualRealityCtrl.attachEvent(&quot;ToolEvent&quot;, ToolEvents); //ARä¸­çš„æ³¨å†Œäº‹ä»¶

function ToolEvents(id, type, data) {
  	var obj = JSON.parse(data); 
  	if (type == &quot;5&quot;) {
      	//å…¶ä»–æ“ä½œ
		$.ajax({
          type: &quot;GET&quot;,
          url: &quot;../data/JsonData/timeMachine.json&quot;,
          success: function (data) {
            //å…¶ä»–æ“ä½œ
          }
  	}
}
</code></pre>
<h2 id="ç»˜åˆ¶æŒ¡æ¿é¢">ç»˜åˆ¶æŒ¡æ¿ï¼ˆé¢ï¼‰</h2>
<blockquote>
<p>æ€è·¯ï¼šé€šè¿‡å°†å·¥å…·<code>type=4</code>ï¼Œè°ƒå‡ºç»˜é¢å·¥å…·ï¼Œç„¶ååœ¨æ³¨å†Œäº‹ä»¶ä¸­æ‹¿åˆ°å¯¹åº”çš„ç‚¹çš„åæ ‡</p>
</blockquote>
<ul>
<li>æ‹¼æ¥æ–°çš„æ•°ç»„</li>
</ul>
<pre><code class="language-javascript">function ToolEvents(id, type, data) { 
  var obj = JSON.parse(data);//dataä¸ºæ•°ç»„åæ ‡åˆé›†
      if (type == &quot;4&quot;) {
          for (var i = 0; i &lt; obj.length; i++) {
              var tem = []
              if (i &lt; obj.length - 1) {
                  tem = [obj[i], obj[i + 1]]
              } else {
                  tem = [obj[i], obj[0]]
              }
              bottomPoint.push(tem)
          }
          VirtualRealityCtrl.ToolManager.ActiveTool = 0;
          drawFace();
   }
}
</code></pre>
<pre><code class="language-javascript">//å½“æ—¶å‡ºç°çš„é—®é¢˜åœ¨äºï¼šåˆ›å»ºçš„æ—¶å€™æŠŠpgParamã€vec3æ”¾åœ¨äº†å¾ªç¯å¤–é¢
function drawFace() {
  for (var i = 0; i &lt; bottomPoint.length; i++) {
      var pgParam = VirtualRealityCtrl.ModelManager.CreatePolygonModelParam(); //åˆ›å»ºçº¿é¢
      var vec3 = VirtualRealityCtrl.UtilManager.CreateInstance(&quot;Vertex&quot;);
      for (var j = 0; j &lt; bottomPoint[i].length; j++) {
          vec3.X = bottomPoint[i][j].X;
          vec3.Y = bottomPoint[i][j].Y;
          vec3.Z = bottomPoint[i][j].Z;
          pgParam.AddVertex(vec3);
      }
      var temArr = bottomPoint[i].reverse();
      for (var k = 0; k &lt; temArr.length; k++) { //åæ ‡å˜æ¢
          vec3.X = temArr[k].X;
          vec3.Y = temArr[k].Y;
          vec3.Z = temArr[k].Z + 5;
          pgParam.AddVertex(vec3);
      }
      pgParam.FillColor = 03333;      //æ·»åŠ å…¶ä»–å±æ€§
      pgParam.ShowSide = true;
      pgParam.SideColor = 03333;
      pgParam.SideWidth = 2;
      var plmodel = VirtualRealityCtrl.ModelManager.CreatePolygonModel(pgParam);
      plmodel.Transparency = 0.5;
      VirtualRealityCtrl.LayerManager.ModelLayer.AddNode(plmodel);//æ·»åŠ åˆ°åœºæ™¯ä¸­
      temArr = []; //æ¸…ç©ºä¸´æ—¶æ•°ç»„
  }
  bottomPoint = [];
}
</code></pre>
<h2 id="vue-å¤é€‰æ¡†çš„ä½¿ç”¨">vue å¤é€‰æ¡†çš„ä½¿ç”¨</h2>
<ul>
<li>
<p>å•ä¸ªå¤é€‰æ¡†ç”¨äºç»‘å®šå¸ƒå°”å€¼</p>
<pre><code class="language-java">&lt;input type=&quot;checkbox&quot; id=&quot;&quot;  v-model=&quot;checked&quot;&gt;  &lt;!-- checked = &quot;true&quot; or &quot;false&quot; --&gt;
</code></pre>
</li>
<li>
<p>å¤šä¸ªå¤é€‰æ¡†ç”¨äºç»‘å®šæ•°ç»„ï¼ˆä¼ å…¥valueå€¼å…¥æ•°ç»„ï¼‰</p>
<pre><code class="language-Java">&lt;input type=&quot;checkbox&quot; id=&quot;a&quot; value=&quot;John&quot; v-model=&quot;checkedNames&quot;&gt;
&lt;label for=&quot;a&quot;&gt;John&lt;/label&gt;
&lt;input type=&quot;checkbox&quot; id=&quot;b&quot; value=&quot;Mike&quot; v-model=&quot;checkedNames&quot;&gt;
&lt;label for=&quot;b&quot;&gt;Mike&lt;/label&gt;
&lt;!-- checkedNamesä¸ºé€‰ä¸­å¤é€‰æ¡†çš„inputå¯¹åº”valueå€¼çš„é›†åˆ --&gt;
</code></pre>
</li>
</ul>
<h2 id="ie11-ä¸‹æ³¨å†Œäº‹ä»¶çš„å…¼å®¹è®¾ç½®">IE11 ä¸‹æ³¨å†Œäº‹ä»¶çš„å…¼å®¹è®¾ç½®</h2>
<blockquote>
<p>Internet Explorer 11 é»˜è®¤æƒ…å†µä¸‹ä¸æ”¯æŒ attachEvent æ³¨å†Œäº‹ä»¶ï¼Œéœ€è¦åœ¨é¡µé¢ä¸­ä¿®æ”¹é»˜è®¤å…¼å®¹è®¾ç½®ä¸ºIE10 æ‰èƒ½ä½¿ç”¨ attachEvent æ³¨å†Œäº‹ä»¶ã€‚ headä¸­æ·»åŠ ï¼š</p>
</blockquote>
<pre><code class="language-java"> &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=10&quot; /&gt;
</code></pre>
]]></content>
    </entry>
</feed>